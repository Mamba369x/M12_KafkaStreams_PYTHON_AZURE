[2024-06-17 15:58:05,149] INFO [ControllerEventThread controllerId=0] Starting (kafka.controller.ControllerEventManager$ControllerEventThread)
[2024-06-17 15:58:05,167] INFO [Controller id=0] 0 successfully elected as the controller. Epoch incremented to 1 and epoch zk version is now 1 (kafka.controller.KafkaController)
[2024-06-17 15:58:05,168] INFO [Controller id=0] Creating FeatureZNode at path: /feature with contents: FeatureZNode(2,Enabled,Map()) (kafka.controller.KafkaController)
[2024-06-17 15:58:05,186] INFO [Controller id=0] Registering handlers (kafka.controller.KafkaController)
[2024-06-17 15:58:05,189] INFO [Controller id=0] Deleting log dir event notifications (kafka.controller.KafkaController)
[2024-06-17 15:58:05,190] INFO [Controller id=0] Deleting isr change notifications (kafka.controller.KafkaController)
[2024-06-17 15:58:05,191] INFO [Controller id=0] Initializing controller context (kafka.controller.KafkaController)
[2024-06-17 15:58:05,200] INFO [Controller id=0] Initialized broker epochs cache: HashMap(0 -> 25) (kafka.controller.KafkaController)
[2024-06-17 15:58:05,203] DEBUG [Controller id=0] Register BrokerModifications handler for Set(0) (kafka.controller.KafkaController)
[2024-06-17 15:58:05,205] DEBUG [Channel manager on controller 0]: Controller 0 trying to connect to broker 0 (kafka.controller.ControllerChannelManager)
[2024-06-17 15:58:05,213] INFO [RequestSendThread controllerId=0] Starting (kafka.controller.RequestSendThread)
[2024-06-17 15:58:05,214] INFO [Controller id=0] Currently active brokers in the cluster: Set(0) (kafka.controller.KafkaController)
[2024-06-17 15:58:05,214] INFO [Controller id=0] Currently shutting brokers in the cluster: HashSet() (kafka.controller.KafkaController)
[2024-06-17 15:58:05,214] INFO [Controller id=0] Current list of topics in the cluster: HashSet() (kafka.controller.KafkaController)
[2024-06-17 15:58:05,214] INFO [Controller id=0] Fetching topic deletions in progress (kafka.controller.KafkaController)
[2024-06-17 15:58:05,216] INFO [Controller id=0] List of topics to be deleted:  (kafka.controller.KafkaController)
[2024-06-17 15:58:05,216] INFO [Controller id=0] List of topics ineligible for deletion:  (kafka.controller.KafkaController)
[2024-06-17 15:58:05,216] INFO [Controller id=0] Initializing topic deletion manager (kafka.controller.KafkaController)
[2024-06-17 15:58:05,216] INFO [Topic Deletion Manager 0] Initializing manager with initial deletions: Set(), initial ineligible deletions: HashSet() (kafka.controller.TopicDeletionManager)
[2024-06-17 15:58:05,217] INFO [Controller id=0] Sending update metadata request (kafka.controller.KafkaController)
[2024-06-17 15:58:05,222] INFO [ReplicaStateMachine controllerId=0] Initializing replica state (kafka.controller.ZkReplicaStateMachine)
[2024-06-17 15:58:05,222] INFO [ReplicaStateMachine controllerId=0] Triggering online replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-06-17 15:58:05,224] INFO [ReplicaStateMachine controllerId=0] Triggering offline replica state changes (kafka.controller.ZkReplicaStateMachine)
[2024-06-17 15:58:05,224] DEBUG [ReplicaStateMachine controllerId=0] Started replica state machine with initial state -> HashMap() (kafka.controller.ZkReplicaStateMachine)
[2024-06-17 15:58:05,224] INFO [PartitionStateMachine controllerId=0] Initializing partition state (kafka.controller.ZkPartitionStateMachine)
[2024-06-17 15:58:05,224] INFO [PartitionStateMachine controllerId=0] Triggering online partition state changes (kafka.controller.ZkPartitionStateMachine)
[2024-06-17 15:58:05,226] DEBUG [PartitionStateMachine controllerId=0] Started partition state machine with initial state -> HashMap() (kafka.controller.ZkPartitionStateMachine)
[2024-06-17 15:58:05,226] INFO [Controller id=0] Ready to serve as the new controller with epoch 1 (kafka.controller.KafkaController)
[2024-06-17 15:58:05,229] WARN [RequestSendThread controllerId=0] Controller 0's connection to broker idrac-natownica-akademik.net.ds.pw.edu.pl:9092 (id: 0 rack: null) was unsuccessful (kafka.controller.RequestSendThread)
java.io.IOException: Connection to idrac-natownica-akademik.net.ds.pw.edu.pl:9092 (id: 0 rack: null) failed.
	at org.apache.kafka.clients.NetworkClientUtils.awaitReady(NetworkClientUtils.java:71)
	at kafka.controller.RequestSendThread.brokerReady(ControllerChannelManager.scala:298)
	at kafka.controller.RequestSendThread.doWork(ControllerChannelManager.scala:251)
	at org.apache.kafka.server.util.ShutdownableThread.run(ShutdownableThread.java:131)
[2024-06-17 15:58:05,229] INFO [Controller id=0] Partitions undergoing preferred replica election:  (kafka.controller.KafkaController)
[2024-06-17 15:58:05,230] INFO [Controller id=0] Partitions that completed preferred replica election:  (kafka.controller.KafkaController)
[2024-06-17 15:58:05,230] INFO [Controller id=0] Skipping preferred replica election for partitions due to topic deletion:  (kafka.controller.KafkaController)
[2024-06-17 15:58:05,230] INFO [Controller id=0] Resuming preferred replica election for partitions:  (kafka.controller.KafkaController)
[2024-06-17 15:58:05,231] INFO [Controller id=0] Starting replica leader election (PREFERRED) for partitions  triggered by ZkTriggered (kafka.controller.KafkaController)
[2024-06-17 15:58:05,239] INFO [Controller id=0] Starting the controller scheduler (kafka.controller.KafkaController)
[2024-06-17 15:58:05,338] INFO [RequestSendThread controllerId=0] Controller 0 connected to idrac-natownica-akademik.net.ds.pw.edu.pl:9092 (id: 0 rack: null) for sending state change requests (kafka.controller.RequestSendThread)
[2024-06-17 15:58:10,247] INFO [Controller id=0] Processing automatic preferred replica leader election (kafka.controller.KafkaController)
[2024-06-17 15:58:10,248] TRACE [Controller id=0] Checking need to trigger auto leader balancing (kafka.controller.KafkaController)
[2024-06-17 15:59:10,916] INFO [QuorumController id=1] Creating new QuorumController with clusterId Z9s5uAM9QaK4uGzeiD50Uw. (org.apache.kafka.controller.QuorumController)
[2024-06-17 15:59:10,918] INFO [QuorumController id=1] Becoming the active controller at epoch 1, next write offset 1. (org.apache.kafka.controller.QuorumController)
[2024-06-17 15:59:10,921] WARN [QuorumController id=1] Performing controller activation. The metadata log appears to be empty. Appending 1 bootstrap record(s) in metadata transaction at metadata.version 3.7-IV4 from bootstrap source 'the binary bootstrap metadata file: /tmp/kraft-combined-logs/bootstrap.checkpoint'. Setting the ZK migration state to NONE since this is a de-novo KRaft cluster. (org.apache.kafka.controller.QuorumController)
[2024-06-17 15:59:10,921] INFO [QuorumController id=1] Replayed BeginTransactionRecord(name='Bootstrap records') at offset 1. (org.apache.kafka.controller.OffsetControlManager)
[2024-06-17 15:59:10,922] INFO [QuorumController id=1] Replayed a FeatureLevelRecord setting metadata version to 3.7-IV4 (org.apache.kafka.controller.FeatureControlManager)
[2024-06-17 15:59:10,922] INFO [QuorumController id=1] Replayed EndTransactionRecord() at offset 4. (org.apache.kafka.controller.OffsetControlManager)
[2024-06-17 15:59:10,999] INFO [QuorumController id=1] Replayed RegisterControllerRecord contaning ControllerRegistration(id=1, incarnationId=IVdQse80SQeu3zsS5LVtfg, zkMigrationReady=false, listeners=[Endpoint(listenerName='CONTROLLER', securityProtocol=PLAINTEXT, host='idrac-natownica-akademik.net.ds.pw.edu.pl', port=9093)], supportedFeatures={metadata.version: 1-19}). (org.apache.kafka.controller.ClusterControlManager)
[2024-06-17 15:59:11,043] INFO [QuorumController id=1] Replayed initial RegisterBrokerRecord for broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=ehdbPwW5SIuePNhQbsKcnA, brokerEpoch=6, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[iL-m8986w9Ar_5EzFZtlpQ]) (org.apache.kafka.controller.ClusterControlManager)
[2024-06-17 15:59:11,095] INFO [QuorumController id=1] Replayed RegisterBrokerRecord modifying the registration for broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=ehdbPwW5SIuePNhQbsKcnA, brokerEpoch=7, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[iL-m8986w9Ar_5EzFZtlpQ]) (org.apache.kafka.controller.ClusterControlManager)
[2024-06-17 15:59:11,128] INFO [QuorumController id=1] Replayed RegisterBrokerRecord modifying the registration for broker 1: RegisterBrokerRecord(brokerId=1, isMigratingZkBroker=false, incarnationId=ehdbPwW5SIuePNhQbsKcnA, brokerEpoch=8, endPoints=[BrokerEndpoint(name='PLAINTEXT', host='localhost', port=9092, securityProtocol=0)], features=[BrokerFeature(name='metadata.version', minSupportedVersion=1, maxSupportedVersion=19)], rack=null, fenced=true, inControlledShutdown=false, logDirs=[iL-m8986w9Ar_5EzFZtlpQ]) (org.apache.kafka.controller.ClusterControlManager)
[2024-06-17 15:59:11,164] INFO [QuorumController id=1] processBrokerHeartbeat: event failed with StaleBrokerEpochException in 64 microseconds. (org.apache.kafka.controller.QuorumController)
[2024-06-17 15:59:11,173] INFO [QuorumController id=1] The request from broker 1 to unfence has been granted because it has caught up with the offset of its register broker record 8. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2024-06-17 15:59:11,176] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=8, fenced=-1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-06-17 15:59:11,217] INFO [QuorumController id=1] Unfenced broker 1 has requested and been granted an immediate shutdown. (org.apache.kafka.controller.BrokerHeartbeatManager)
[2024-06-17 15:59:11,217] INFO [QuorumController id=1] Replayed BrokerRegistrationChangeRecord modifying the registration for broker 1: BrokerRegistrationChangeRecord(brokerId=1, brokerEpoch=8, fenced=1, inControlledShutdown=0, logDirs=[]) (org.apache.kafka.controller.ClusterControlManager)
[2024-06-17 15:59:11,408] INFO [QuorumController id=1] writeNoOpRecord: event unable to start processing because of RejectedExecutionException (treated as TimeoutException). (org.apache.kafka.controller.QuorumController)
